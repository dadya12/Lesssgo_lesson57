{% extends 'base.html' %}

{% block navbar %}
    {% if request.user.is_authenticated %}
        {% if perms.webapp.add_project %}
            <a class="nav-link active" aria-current="page" href="{% url 'webapp:create' %}">Create Project</a>
            <span style="margin-top: 8px; color: white">|</span>
        {% endif %}
    {% endif %}
{% endblock %}

<title>{% block title %}Projects{% endblock %}</title>

{% block content %}

    <div style="margin-top: 50px">
        {% include 'partial/search.html' %}
    </div>

    <center>
        {% if request.user.is_authenticated %}
            <h1 style="margin-top: 50px">Your Projects:</h1>
        {% else %}
            <h1 style="color: red; padding-top: 50px"><b>You Must Log In</b></h1>
        {% endif %}
    </center>
    <div class="row row-cols-3">
        {% for p in projects %}
            <div class="col">
                <div class="card mb-3"
                     style="width: 18rem; border-radius: 20px; margin-top: 50px; border: 3px solid green">
                    <div class="card-body">
                        <h4 class="card-title" style="margin-bottom: 20px">{{ p.name }}</h4>
                        <hr>
                        <h6 class="card-text" style="font-size: 14px; margin-bottom: 20px">
                            Description: {{ p.description }}</h6>
                        {% if request.user.is_authenticated %}
                            <a href="{% url 'webapp:detail' p.pk %}" class="btn btn-success">See more</a>
                            {% if perms.webapp.change_project and request.user in p.users.all %}
                            <a href="{% url 'webapp:edit' p.pk %}" class="btn btn-dark" style="margin-left: 40px;">Edit
                                Project</a>
                            {% endif %}
                        {% else %}
                            <h5 style="color: red; padding-top: 20px"><b>You Must Log In</b></h5>
                        {% endif %}
                    </div>
                <span style="color: black; padding-left: 10px">
                    <b>Пользователь:</b>
                    {% for user in p.users.all %}
                        {{ user.username }}
                        {% if not forloop.last %},
                        {% endif %}
                    {% endfor %}
                </span>
                </div>
            </div>
        {% empty %}
            <h5>Project Not Found :( </h5>
        {% endfor %}
    </div>
    <div class="container" style="margin-bottom: 50px; align-items: center">
        {% if is_paginated %}
            {% include 'partial/pagination.html' %}
        {% endif %}
    </div>
{% endblock %}